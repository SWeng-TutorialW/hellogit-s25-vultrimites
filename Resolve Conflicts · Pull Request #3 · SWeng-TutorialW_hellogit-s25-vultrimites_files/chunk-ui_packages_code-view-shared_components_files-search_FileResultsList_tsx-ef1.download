"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_code-view-shared_components_files-search_FileResultsList_tsx"],{91385:(e,t,r)=>{r.d(t,{Xq:()=>o,ai:()=>n,fN:()=>s,qA:()=>i});var a=-1/0,n=1/0;function l(e,t,r,n){for(var l=e.length,s=t.length,o=e.toLowerCase(),i=t.toLowerCase(),c=function(e){for(var t=e.length,r=Array(t),a="/",n=0;n<t;n++){var l,s=e[n];"/"===a?r[n]=.9:"-"===a||"_"===a||" "===a?r[n]=.8:"."===a?r[n]=.6:(l=a).toLowerCase()===l&&s.toUpperCase()===s?r[n]=.7:r[n]=0,a=s}return r}(t,c),u=0;u<l;u++){r[u]=Array(s),n[u]=Array(s);for(var d=a,f=u===l-1?-.005:-.01,h=0;h<s;h++)if(o[u]===i[h]){var m=a;u?h&&(m=Math.max(n[u-1][h-1]+c[h],r[u-1][h-1]+1)):m=-.005*h+c[h],r[u][h]=m,n[u][h]=d=Math.max(m,d+f)}else r[u][h]=a,n[u][h]=d+=f}}function s(e,t){var r=e.length,s=t.length;if(!r||!s)return a;if(r===s)return n;if(s>1024)return a;var o=Array(r),i=Array(r);return l(e,t,o,i),i[r-1][s-1]}function o(e,t){var r=e.length,n=t.length,s=Array(r);if(!r||!n)return s;if(r===n){for(var o=0;o<r;o++)s[o]=o;return s}if(n>1024)return s;var i=Array(r),c=Array(r);l(e,t,i,c);for(var u=!1,o=r-1,d=n-1;o>=0;o--)for(;d>=0;d--)if(i[o][d]!==a&&(u||i[o][d]===c[o][d])){u=o&&d&&c[o][d]===i[o-1][d-1]+1,s[o]=d--;break}return s}function i(e,t){e=e.toLowerCase(),t=t.toLowerCase();for(var r=e.length,a=0,n=0;a<r;a+=1)if(0===(n=t.indexOf(e[a],n)+1))return!1;return!0}},83023:(e,t,r)=>{r.d(t,{o:()=>d});var a=r(5225),n=r(17908),l=r(5796),s=r(57572),o=r(96540);async function i(e){let t=await (0,s.lS)(e);return t.ok?await t.json():void 0}let c=new Map,u=(0,a.A)(i,{cache:c});function d(e,t,r){let a=(0,n.t)(),[s,i]=(0,o.useState)({list:[],directories:[],loading:!0}),c=(0,l.ClY)({repo:a,commitOid:e,includeDirectories:!r});return(0,o.useEffect)(()=>{let e=!1,r=async()=>{i({list:[],directories:[],loading:!0});let t=await u(c);if(e)return;let r=t?.paths||[],a=t?.directories||[];i({list:r.concat(a).sort(),directories:a,error:!t})};return t&&r(),function(){e=!0}},[c,t,r]),s}},73412:(e,t,r)=>{function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{z:()=>WebWorker});let WebWorker=class WebWorker{set onmessage(e){this.worker.onmessage=e}postMessage(e){this.worker.postMessage(e)}terminate(){this.worker.terminate()}constructor(e,t){a(this,"worker",void 0);try{this.worker=new Worker(`${e}?module=true`,{type:"module"})}catch{console.warn("Web workers are not available. Please enable web workers to benefit from the improved performance."),this.worker=new MainThreadWorker(t)}}};let MainThreadWorker=class MainThreadWorker{async postMessage(e){if(this.terminated)return;let t={data:this.job({data:e})};this.onmessage?.(t)}terminate(){this.terminated=!0}constructor(e){a(this,"terminated",!1),a(this,"onmessage",void 0),this.job=e}}},7911:(e,t,r)=>{r.d(t,{j:()=>s});var a=r(5225),n=r(91385);let l=(0,a.A)(n.fN);function s({data:e}){let{query:t,baseList:r,startTime:a}=e,s=t.replaceAll("\\","");return{query:t,list:r.filter(e=>""===s||(0,n.qA)(s,e)&&l(s,e)>0).sort((e,t)=>l(s,t)-l(s,e)),baseCount:r.length,startTime:a}}},69252:(e,t,r)=>{r.d(t,{U:()=>l});let a=e=>{let t=getComputedStyle(e,null);return["overflow","overflow-y","overflow-x"].some(e=>{let r=t.getPropertyValue(e);return"auto"===r||"scroll"===r})},n=(e,t)=>e&&null!==e.parentNode?n(e.parentNode,t.concat([e])):t;function l(e){if(e instanceof HTMLElement||e instanceof SVGElement){for(let t of n(e.parentNode,[]))if((t instanceof HTMLElement||t instanceof SVGElement)&&a(t))return t;return document.scrollingElement||document.documentElement}}},11024:(e,t,r)=>{r.r(t),r.d(t,{FileResultRow:()=>I,default:()=>F});var a=r(74848),n=r(23832),l=r(14194),s=r(78904),o=r(38556),i=r(17908),c=r(69252),u=r(5796),d=r(17774),f=r(41980),h=r(46928),m=r(69676),p=r(38621),x=r(82678),g=r(75177),v=r(65481),y=r(8338),w=r(34614),b=r(85349),A=r(63867),C=r(30729),E=r(91385),R=r(96540),j=r(73412),N=r(7911),S=r(14757),k=r(83023);let L={excludeDirectories:!1,excludeSeeAllResults:!1};function F({actionListSx:e,additionalResults:t,commitOid:r,config:d=L,findFileWorkerPath:p,getItemUrl:A,onRenderRow:C,onItemSelected:E,searchBoxRef:F,sx:I}){let{excludeDirectories:M,excludeSeeAllResults:_}=d,{query:D,setQuery:W}=(0,n.JS)(),H=(0,i.t)(),$=R.useRef(null),V=F??$,[z,G]=R.useState(D.length>0),[O,P]=R.useState(!!D),{list:U,directories:Y,loading:Z,error:B}=(0,k.o)(r,z,!!M),{path:K}=(0,l.eu)(),{getUrl:X}=(0,o.Z)(),{queryText:J,queryLine:Q}=function(e){let t=(e=e.replaceAll(" ","")).indexOf(":");return t>=0?{queryText:e.substring(0,t),queryLine:parseInt(e.substring(t+1),10)}:{queryText:e,queryLine:void 0}}(D),{matches:ee,clearMatches:et}=function(e,t,r,a){let[n,l]=R.useState(),o=R.useRef(""),i=R.useRef(),{sendStats:c}=(0,s.T)(),u=R.useRef(!1),d=R.useCallback(()=>{let e=new j.z(r,N.j);e.onmessage=({data:e})=>{u.current=!1,l(e.list),o.current=e.query,e.startTime&&c("repository.find-file",{"find-file-base-count":e.baseCount,"find-file-results-count":e.list.length,"find-file-duration-ms":performance.now()-e.startTime})},i.current=e},[c,r]);return R.useEffect(()=>{if(a)return d(),function(){i.current?.terminate()}},[d,a]),R.useEffect(()=>{if(e.length&&t){u.current&&(i.current?.terminate(),d());let r=o.current&&t.startsWith(o.current);u.current=!0,i.current?.postMessage({baseList:r&&n||e,query:t,startTime:performance.now()})}},[e,t,d]),{matches:n,clearMatches:()=>l(void 0)}}((0,R.useMemo)(()=>[...U,...t??[]].sort(),[t,U]),J,p,z),{sendRepoClickEvent:er}=(0,s.T)(),ea=(0,h.Z)(),[en,el]=R.useState(0),[es,eo]=R.useState(()=>(0,S.q)()),ei=R.useRef(null),ec=R.useRef(null),eu="file-results-list",{sendRepoKeyDownEvent:ed}=(0,s.T)(),{screenSize:ef}=(0,f.lm)(),eh=d.enableOverlay??ef>=f.Gy.large,em=R.useCallback(e=>{er("FILE_TREE.SEARCH_RESULT_CLICK"),E?.(e),P(!1)},[er,E]),ep=(e,t,r)=>A?A(e,t,r):X({path:e,action:t?"tree":"blob",hash:r}),{containerRef:ex}=(0,x.G)({bindKeys:m.z0.ArrowVertical|m.z0.HomeAndEnd,focusInStrategy:"previous"},[Z,B]);R.useEffect(()=>{D||P(!1)},[D]),R.useEffect(()=>{document.activeElement!==V.current&&eh&&P(!1)},[K,V,eh]);let eg=ee?.slice(0,40)||[],ev=ee&&ee.length>eg.length,ey=(0,a.jsx)(g.A,{sx:{maxHeight:eh?"60vh":"100% !important",overflowY:"auto",scrollbarGutter:"stable",maxWidth:"100vw","@media (max-width: 768px)":{ml:3,mr:2}},children:B?(0,a.jsx)(v.A,{variant:"danger",className:"m-3",children:"Failed to search"}):(0,a.jsxs)(y.l,{ref:ex,sx:{overflow:"auto",p:eh?2:3,width:"100%",pr:eh?3:0,pt:eh?3:"2px !important",...e},role:"listbox",children:[!Z&&eg.map((e,t)=>{let r=Y.includes(e),n=ep(e,r,Q?`L${Q}`:"");return(0,a.jsx)(q,{active:e===K,index:t,focused:es&&en===t,match:e,onRender:C,query:J,onClick:em,isDirectory:r,to:n,useOverlay:eh,listRef:ex},e)}),(0,a.jsxs)("div",{className:"m-3 text-center",children:[(0,a.jsx)(T,{loading:Z||!ee,visibleResultCount:eg.length,truncated:!!ev}),ev&&!_&&(0,a.jsxs)(a.Fragment,{children:["\xa0",(0,a.jsx)(w.A,{id:"see-all-results-link",className:"focus-visible",ref:ei,href:(0,u.Y8Y)({owner:H.ownerLogin,repo:H.name,searchTerm:`path:${J}`}),sx:es&&en===eg.length?{outline:"2px solid var(--focus-outlineColor, var(--color-accent-fg))",outlineOffset:"-2px",boxShadow:"none"}:{},children:"See all results"})]})]})]})});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g.A,{ref:ec,sx:{mx:2,...I},children:(0,a.jsx)(S.Z,{ariaActiveDescendant:(!eh&&D||eh&&O)&&es&&en>-1?ev&&en===eg.length?"see-all-results-link":`file-result-${en}`:void 0,ariaExpanded:eh?O:void 0,ariaHasPopup:eh,ariaControls:eh?eu:void 0,ref:V,query:D,onKeyDown:e=>{let{key:t,shiftKey:r,metaKey:a,altKey:n,ctrlKey:l}=e;if(!r&&!a&&!n){if("Escape"===t)D?(ed("FILE_TREE.CANCEL_SEARCH"),W(""),et()):document.activeElement&&document.activeElement.blur();else if(!D)return;else if("Enter"===t){if(!_&&ev&&en===eg.length)ea((0,u.Y8Y)({owner:H.ownerLogin,repo:H.name,searchTerm:`path:${J}`})),E?.();else if(eg[en]){let e=eg[en];ea(ep(eg[en],!1,Q?`L${Q}`:"")),P(!1),E?.(e)}}else if("ArrowDown"===t||l&&"n"===t){if(!_&&ev&&en>=eg.length-1){if(el(eg.length),ei.current&&ex.current){let e=(0,c.U)(ex.current);(0,m.Rt)(ei.current,e,{behavior:"instant"})}}else el(Math.min(en+1,eg.length-1));e.preventDefault();return}else if("ArrowUp"===t||l&&"p"===t){el(Math.max(en-1,0)),e.preventDefault();return}}},onPreload:()=>G(!0),onSearch:e=>{W(e),e?P(!0):(et(),P(!1)),el(0)},onBlur:e=>{ex.current?.contains(e.relatedTarget)||(P(!1),eo(!1))},onFocus:()=>{D&&P(!0),eo(!0)},sx:{minWidth:"160px"}})}),eh&&(0,a.jsx)(b.T,{anchorRef:ec,open:eh&&O,renderAnchor:null,onClose:()=>{P(!1)},focusZoneSettings:{disabled:!0},focusTrapSettings:{disabled:!0},width:"xlarge",align:"end",overlayProps:{id:eu,role:"dialog"},children:ey}),!eh&&D&&ey]})}function T({visibleResultCount:e,truncated:t,loading:r}){return(0,a.jsx)("span",{role:"status",className:r||t||0===e?void 0:"sr-only","aria-label":r?"Loading":void 0,children:r?(0,a.jsx)(A.A,{size:"large"}):0===e?"No matches found":t?`First ${e} files shown.`:`Showing ${e} files.`},"results-count-status")}let I=({active:e,focused:t,index:r,match:n,query:l,to:s,isDirectory:o,onClick:i,onRender:u,useOverlay:f,listRef:h})=>{let p=(0,E.Xq)(l,n);u?.();let x=R.useRef(null),v=o?M:_;R.useEffect(()=>{if(t&&x.current&&h?.current){let e=(0,c.U)(h.current);(0,m.Rt)(x.current,e,{behavior:"instant"})}},[t,h]);let w={};t&&(w={outline:"none",border:"2 solid",boxShadow:"0 0 0 2px #0969da"});let b=(0,R.useCallback)(()=>{i?.(n)},[n,i]);return(0,a.jsx)(y.l.Item,{id:`file-result-${r}`,ref:x,as:d.N,onSelect:b,to:s,active:e,className:"d-flex",sx:{fontWeight:"normal",":hover":{textDecoration:"none"},mx:"2px",width:"calc(100% - 4px)",...w},role:"option","data-focus-visible-added":t||void 0,tabIndex:f?-1:0,children:(0,a.jsxs)("div",{className:"d-flex",children:[(0,a.jsx)("div",{className:"d-flex flex-1 flex-column overflow-hidden",children:(0,a.jsx)(D,{text:n,positionsList:p,sx:{color:"fg.muted"},LeadingIcon:v})}),t&&(0,a.jsx)(g.A,{sx:{pl:1,whiteSpace:"nowrap",color:"fg.muted"},children:`Go to ${o?"folder":"file"}`})]})},n)},M=()=>(0,a.jsx)(C.A,{"aria-label":"Directory",icon:p.FileDirectoryFillIcon,sx:{color:"var(--treeViewItem-leadingVisual-iconColor-rest, var(--color-icon-directory))",mr:2},size:"small"}),_=()=>(0,a.jsx)(C.A,{"aria-label":"File",icon:p.FileIcon,className:"fgColor-muted mr-2",size:"small"}),q=R.memo(I);function D({text:e,positionsList:t,sx:r,LeadingIcon:n}){let l=[],s=0;for(let r of t){if(Number(r)!==r||r<s||r>e.length)continue;let t=e.slice(s,r);t&&l.push(W(t)),s=r+1,l.push((0,a.jsx)("mark",{className:"text-bold bgColor-transparent fgColor-default",children:e[r]},r))}return l.push(W(e.slice(s))),(0,a.jsx)(g.A,{sx:r,children:(0,a.jsxs)(a.Fragment,{children:[n&&(0,a.jsx)(n,{}),l]})})}function W(e){return e.replaceAll("/","/\u200B")}try{F.displayName||(F.displayName="FileResultsList")}catch{}try{T.displayName||(T.displayName="FileResultsStatus")}catch{}try{I.displayName||(I.displayName="FileResultRow")}catch{}try{M.displayName||(M.displayName="DirectoryIcon")}catch{}try{_.displayName||(_.displayName="FileResultIcon")}catch{}try{q.displayName||(q.displayName="MemoizedFileResultRow")}catch{}try{D.displayName||(D.displayName="HighlightMatch")}catch{}},14757:(e,t,r)=>{r.d(t,{Z:()=>f,q:()=>h});var a=r(74848),n=r(70170),l=r(6262),s=r(78904),o=r(47584),i=r(38621),c=r(67138),u=r(75177),d=r(96540);let f=d.forwardRef(({ariaActiveDescendant:e,ariaControls:t,ariaExpanded:r,ariaHasPopup:o,onBlur:f,onFocus:m,onKeyDown:p,onPreload:x,onSearch:g,query:v,sx:y},w)=>{let{sendRepoClickEvent:b}=(0,s.T)(),[A,C]=d.useState(v),E=d.useRef((0,n.s)(e=>g(e),250));d.useEffect(()=>{C(v)},[v]);let R=v?(0,a.jsx)(c.A.Action,{onClick:()=>{b("FILE_TREE.CANCEL_SEARCH"),g("")},icon:i.XCircleFillIcon,"aria-label":"Clear",className:"fgColor-muted"}):void 0;return(0,a.jsx)(c.A,{autoFocus:h(),ref:w,value:A,onKeyDown:p,onChange:e=>{C(e.target.value),x(),E.current(e.target.value)},sx:{display:"flex",...y},"aria-label":"Go to file","aria-activedescendant":e,role:o?"combobox":void 0,"aria-controls":t,"aria-expanded":r,"aria-haspopup":o?"dialog":void 0,autoCorrect:"off",spellCheck:"false",placeholder:"Go to file",leadingVisual:i.SearchIcon,trailingAction:R,trailingVisual:R?void 0:()=>(0,a.jsx)(l.E,{children:(0,a.jsx)(u.A,{sx:{mr:"-6px"},children:(0,a.jsx)("kbd",{children:"t"})})}),onFocus:e=>{x(),e.target.select(),m?.(e)},onBlur:f,onClick:()=>b("FILE_TREE.SEARCH_BOX")})});function h(){return"1"===new URLSearchParams(o.fV.search).get("search")}f.displayName="FilesSearchBox"}}]);
//# sourceMappingURL=ui_packages_code-view-shared_components_files-search_FileResultsList_tsx-4e9b04d7be72.js.map